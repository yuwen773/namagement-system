# Enterprise HRMS

ä¼ä¸šäººåŠ›èµ„æºç®¡ç†ç³»ç»Ÿ - åŸºäº Django 5.x + Vue 3 çš„ç°ä»£åŒ–äººäº‹ç®¡ç†å¹³å°ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ä»‹ç»](#é¡¹ç›®ä»‹ç»)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [åŠŸèƒ½æ¨¡å—](#åŠŸèƒ½æ¨¡å—)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ ¸å¿ƒä¸šåŠ¡è§„åˆ™](#æ ¸å¿ƒä¸šåŠ¡è§„åˆ™)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
- [æƒé™ç³»ç»Ÿ](#æƒé™ç³»ç»Ÿ)

---

## é¡¹ç›®ä»‹ç»

Enterprise HRMS æ˜¯ä¸€ä¸ªè½»é‡çº§ã€æ•°æ®é©±åŠ¨çš„ä¼ä¸šäººäº‹ç®¡ç†ç³»ç»Ÿï¼Œæ ¸å¿ƒè§£å†³ä¼ä¸šå†…éƒ¨"äººä¸ç»„ç»‡"çš„æ•°æ®å­¤å²›é—®é¢˜ï¼Œå®ç°ä»å‘˜å·¥å…¥èŒã€æ—¥å¸¸è€ƒå‹¤ã€è–ªèµ„è®¡ç®—åˆ°æ•°æ®å¯è§†åŒ–çš„å…¨æµç¨‹é—­ç¯ç®¡ç†ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **æ•°æ®å¼ºå…³è”**ï¼šéƒ¨é—¨-å²—ä½-å‘˜å·¥-è€ƒå‹¤-è–ªèµ„å±‚å±‚ä¾èµ–
- **å¯è§†åŒ–é‡å¿ƒ**ï¼šECharts é©¾é©¶èˆ±è§†å›¾ï¼Œç›´è§‚å‘ˆç°ä¼ä¸šè¿è¥æ•°æ®
- **ä¸­æ–‡å‹å¥½**ï¼šå…¨ç³»ç»Ÿä¼˜å…ˆä½¿ç”¨çœŸå®ä¸­æ–‡å§“å
- **å®¡æ‰¹æµ**ï¼šè¯·å‡/åŠ ç­ç”³è¯·åœ¨çº¿å®¡æ‰¹
- **è‡ªåŠ¨åŒ–è®¡ç®—**ï¼šè–ªèµ„ã€è€ƒå‹¤çŠ¶æ€è‡ªåŠ¨æ ¸ç®—

---

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| åç«¯ | Django 5.2 + Django REST Framework + MySQL 8.0 (ç«¯å£ 3307) |
| å‰ç«¯ | Vue 3.5 + Vite + Element Plus 2.x + ECharts |
| è®¤è¯ | JWT (djangorestframework-simplejwt): Access 2h, Refresh 7d |
| çŠ¶æ€ç®¡ç† | Pinia |

---

## åŠŸèƒ½æ¨¡å—

| æ¨¡å— | åŠŸèƒ½æè¿° |
|------|----------|
| **ç”¨æˆ·è®¤è¯** | æ³¨å†Œã€ç™»å½•ã€Token åˆ·æ–°ã€å¯†ç é‡ç½® |
| **ç»„ç»‡æ¶æ„** | éƒ¨é—¨æ ‘å½¢ç®¡ç†ã€å²—ä½æ± ç»´æŠ¤ |
| **å‘˜å·¥æ¡£æ¡ˆ** | å…¥èŒåŠç†ã€ç¦»èŒç®¡ç†ã€ä¸ªäººä¿¡æ¯ç¼–è¾‘ä¸å®¡æ ¸ |
| **è€ƒå‹¤ç®¡ç†** | æ¯æ—¥ç­¾åˆ°/ç­¾é€€ã€è‡ªåŠ¨è®¡ç®—è€ƒå‹¤çŠ¶æ€ |
| **å®¡æ‰¹ä¸­å¿ƒ** | è¯·å‡/åŠ ç­ç”³è¯·ã€åœ¨çº¿å®¡æ‰¹ |
| **è–ªèµ„ç®¡ç†** | è‡ªåŠ¨è–ªèµ„è®¡ç®—ã€å·¥èµ„æ¡æŸ¥çœ‹ã€ç”³è¯‰å¤„ç† |
| **å…¬å‘Šç®¡ç†** | Markdown å…¬å‘Šå‘å¸ƒã€ç½®é¡¶åŠŸèƒ½ |
| **ç»©æ•ˆç®¡ç†** | ç»©æ•ˆè¯„ä¼°ã€è‰ç¨¿â†’å‘å¸ƒæµç¨‹ |
| **æ•°æ®ä¸­å¿ƒ** | å¯è§†åŒ–é©¾é©¶èˆ±ã€ç»Ÿè®¡åˆ†ææŠ¥è¡¨ |

---

## é¡¹ç›®ç»“æ„

```
Enterprise-HRMS/
â”œâ”€â”€ backend/                    # Django åç«¯
â”‚   â”œâ”€â”€ HRMS/                   # é¡¹ç›®é…ç½®
â”‚   â”‚   â”œâ”€â”€ settings.py         # æ•°æ®åº“ã€CORSã€JWT é…ç½®
â”‚   â”‚   â””â”€â”€ urls.py             # è·¯ç”±å…¥å£
â”‚   â”œâ”€â”€ accounts/               # ç”¨æˆ·è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ organization/           # ç»„ç»‡æ¶æ„æ¨¡å—
â”‚   â”œâ”€â”€ employee/               # å‘˜å·¥æ¡£æ¡ˆæ¨¡å—
â”‚   â”œâ”€â”€ attendance/             # è€ƒå‹¤ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ salary/                 # è–ªèµ„ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ approval/               # å®¡æ‰¹æµæ¨¡å—
â”‚   â”œâ”€â”€ notice/                 # å…¬å‘Šç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ performance/            # ç»©æ•ˆç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ dashboard/              # æ•°æ®ä»ªè¡¨ç›˜æ¨¡å—
â”‚
â”œâ”€â”€ frontend/                   # Vue å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/                # API æ¥å£å°è£…
â”‚   â”‚   â”œâ”€â”€ stores/             # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ views/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ index.html
â”‚
â”œâ”€â”€ memory-bank/                # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ product-requirement-document.md
â”‚   â”œâ”€â”€ architecture.md
â”‚   â””â”€â”€ implementation-plan.md
â”‚
â””â”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
```

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.10 ~ 3.12 (æ¨è 3.12)
- **Node.js**: 16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **MySQL**: 8.0 (ç«¯å£ 3306 æˆ– 3307)

### åç«¯å¯åŠ¨

```bash
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (æ¨è)
python -m venv venv
# Windows: venv\Scripts\activate
# Linux/Mac: source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æ•°æ®åº“è¿ç§»
python manage.py migrate

# å¯åŠ¨æœåŠ¡ (ç«¯å£ 8000)
python manage.py runserver
```

### å‰ç«¯å¯åŠ¨

```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (ç«¯å£ 5173)
npm run dev

# ç”Ÿäº§æ„å»º
npm run build
```

### é»˜è®¤è®¿é—®

- **å‰ç«¯**: http://localhost:5173
- **åç«¯ API**: http://localhost:8000

### æ•°æ®åº“é…ç½®

é¡¹ç›®é»˜è®¤ä½¿ç”¨ MySQL **3307** ç«¯å£ã€‚å¦‚éœ€ä½¿ç”¨æ ‡å‡†ç«¯å£ **3306**ï¼Œè¯·ä¿®æ”¹ `backend/HRMS/settings.py`:

```python
# ä¿®æ”¹å‰ (é»˜è®¤é…ç½®)
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.mysql",
        "HOST": "localhost",
        "PORT": "3307",  # é»˜è®¤ç«¯å£
        ...
    }
}

# ä¿®æ”¹å (3306 ç«¯å£)
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.mysql",
        "HOST": "localhost",
        "PORT": "3306",  # æ”¹ä¸º 3306
        ...
    }
}
```

> **æ³¨æ„**: ç¡®ä¿æå‰åˆ›å»ºæ•°æ®åº“ `hrms_db`ï¼Œæˆ–ä¿®æ”¹ `NAME` ä¸ºä½ çš„æ•°æ®åº“åã€‚

---

## æ ¸å¿ƒä¸šåŠ¡è§„åˆ™

### å·¥å·ç”Ÿæˆè§„åˆ™

å·¥å·æ ¼å¼ï¼š`EMP{YYYYMM}{DEPT}{SEQ}`

ç¤ºä¾‹ï¼š`EMP202401TECH001`

- `YYYYMM`: åŠç†å…¥èŒçš„å¹´æœˆ
- `DEPT`: éƒ¨é—¨ç¼©å†™ (å¦‚ TECH=æŠ€æœ¯éƒ¨, HR=äººäº‹éƒ¨)
- `SEQ`: 3ä½æµæ°´å·

### è–ªèµ„è®¡ç®—å…¬å¼

```
å®å‘å·¥èµ„ = åŸºæœ¬å·¥èµ„ + åŠ ç­è´¹ - è€ƒå‹¤æ‰£æ¬¾

åŠ ç­è´¹ = åŠ ç­æ—¶æ•° Ã— æ—¶è–ª
æ—¶è–ª = åŸºæœ¬å·¥èµ„ / 22 / 8

è€ƒå‹¤æ‰£æ¬¾ = (è¿Ÿåˆ°æ¬¡æ•° + æ—©é€€æ¬¡æ•°) Ã— 50
```

### è€ƒå‹¤è§„åˆ™ (09:00 - 18:00)

| åœºæ™¯ | è€ƒå‹¤çŠ¶æ€ |
|------|----------|
| 9:00 åç­¾åˆ° | late (è¿Ÿåˆ°) |
| 18:00 å‰ç­¾é€€ | early (æ—©é€€) |
| 9:00 å‰ç­¾åˆ°ä¸” 18:00 åç­¾é€€ | normal (æ­£å¸¸) |
| æ— æ‰“å¡è®°å½• | absent (ç¼ºå¡) |
| æœ‰å·²é€šè¿‡è¯·å‡ç”³è¯· | leave (ä¼‘å‡) |

---

## API æ–‡æ¡£

### è®¤è¯æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/auth/register/` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/api/auth/login/` | POST | ç”¨æˆ·ç™»å½• |
| `/api/auth/token/refresh/` | POST | åˆ·æ–° Token |

### å‘˜å·¥æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ | æƒé™ |
|------|------|------|------|
| `/api/employee/` | GET | å‘˜å·¥åˆ—è¡¨ | HR/Admin |
| `/api/employee/` | POST | åŠç†å…¥èŒ | HR/Admin |
| `/api/employee/pending/` | GET | å¾…å…¥èŒåˆ—è¡¨ | HR/Admin |
| `/api/employee/options/` | GET | å‘˜å·¥é€‰æ‹©åˆ—è¡¨ | HR/Admin |

### è€ƒå‹¤æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/attendance/check-in/` | POST | ç­¾åˆ° |
| `/api/attendance/check-out/` | POST | ç­¾é€€ |
| `/api/attendance/my-records/` | GET | æˆ‘çš„è€ƒå‹¤è®°å½• |
| `/api/attendance/records/` | GET | æ‰€æœ‰è€ƒå‹¤è®°å½• |

### å®¡æ‰¹æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/approval/requests/` | GET | æˆ‘çš„ç”³è¯·åˆ—è¡¨ |
| `/api/approval/pending/` | GET | å¾…æˆ‘å®¡æ‰¹ (HR/Admin) |
| `/api/approval/requests/` | POST | æäº¤ç”³è¯· |
| `/api/approval/requests/{id}/approve/` | POST | å®¡æ‰¹é€šè¿‡ |
| `/api/approval/requests/{id}/reject/` | POST | å®¡æ‰¹é©³å› |

### è–ªèµ„æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/salary/records/` | GET | è–ªèµ„è®°å½•åˆ—è¡¨ |
| `/api/salary/calculate/` | POST | è®¡ç®—è–ªèµ„ (HR/Admin) |
| `/api/salary/my-records/` | GET | æˆ‘çš„å·¥èµ„æ¡ |

### å…¬å‘Šæ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/notice/notices/` | GET | å…¬å‘Šåˆ—è¡¨ |
| `/api/notice/notices/` | POST | å‘å¸ƒå…¬å‘Š (HR/Admin) |
| `/api/notice/notices/{id}/` | DELETE | åˆ é™¤å…¬å‘Š |

### ä»ªè¡¨ç›˜æ¨¡å—

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/dashboard/stats/` | GET | ç»Ÿè®¡æ•°æ® |
| `/api/dashboard/department-distribution/` | GET | éƒ¨é—¨äººæ•°åˆ†å¸ƒ |
| `/api/dashboard/salary-trend/` | GET | è–ªèµ„è¶‹åŠ¿ |

---

## æƒé™ç³»ç»Ÿ (RBAC)

### ç”¨æˆ·è§’è‰²

| è§’è‰² | è¯´æ˜ |
|------|------|
| `employee` | æ™®é€šå‘˜å·¥ |
| `hr` | äººäº‹ä¸“å‘˜ |
| `admin` | ç³»ç»Ÿç®¡ç†å‘˜ |

### æƒé™ç±»

| æƒé™ç±» | é€»è¾‘ | ç”¨é€” |
|--------|------|------|
| `IsAdmin` | `user.role == 'admin'` | Dashboard ç»Ÿè®¡ã€ç”¨æˆ·ç®¡ç† |
| `IsHROrAdmin` | `role in ['hr','admin']` | è–ªèµ„è®¡ç®—ã€å‘˜å·¥ç®¡ç† |
| `IsEmployeeOrHROrAdmin` | å‘˜å·¥çœ‹è‡ªå·±ï¼ŒHR/Admin çœ‹å…¨éƒ¨ | æ¡£æ¡ˆã€è€ƒå‹¤ã€è–ªèµ„ |
| `IsOwnerOrHROrAdmin` | `obj.user == request.user` | æ•æ„Ÿæ•°æ® |

### è·¯ç”±æƒé™æ§åˆ¶

å‰ç«¯é€šè¿‡è·¯ç”±å…ƒä¿¡æ¯ `meta.roles` æ§åˆ¶è®¿é—®æƒé™ï¼š

```javascript
router.beforeEach((to, from, next) => {
  const roles = to.meta.roles || []
  if (roles.length && !roles.includes(user.value?.role)) {
    return next('/notices')  // æ— æƒé™è·³è½¬
  }
  next()
})
```

---

## æ•°æ®åº“è¡¨

| è¡¨å | æ¨¡å— | è¯´æ˜ |
|------|------|------|
| `accounts_user` | accounts | æ‰©å±•ç”¨æˆ·è¡¨ |
| `organization_department` | organization | éƒ¨é—¨æ ‘å½¢è¡¨ |
| `organization_post` | organization | å²—ä½è¡¨ |
| `employee_employeeprofile` | employee | å‘˜å·¥æ¡£æ¡ˆè¡¨ |
| `attendance_attendance` | attendance | è€ƒå‹¤è®°å½•è¡¨ |
| `salary_salaryrecord` | salary | è–ªèµ„è®°å½•è¡¨ |
| `approval_approvalrequest` | approval | å®¡æ‰¹è¯·æ±‚è¡¨ |
| `notice_notice` | notice | å…¬å‘Šè¡¨ |
| `performance_performancereview` | performance | ç»©æ•ˆè¯„ä¼°è¡¨ |

---

## å“åº”æ ¼å¼

### åˆ—è¡¨æ¥å£

```json
{
  "code": 0,
  "data": [...],
  "total": n
}
```

### å•æ¡æ¥å£

```json
{
  "code": 0,
  "data": {...}
}
```

### å®¡æ‰¹æµçŠ¶æ€

`pending` â†’ `approved` / `rejected`

---

## å¼€å‘è§„èŒƒ

### ä¸­æ–‡ä¼˜å…ˆ

- ä½¿ç”¨ `real_name` è€Œé `username`
- API å“åº”å’Œç•Œé¢æ˜¾ç¤ºä¼˜å…ˆä½¿ç”¨ä¸­æ–‡

### ViewSet æ¨¡å¼

- `get_serializer_class()` åŠ¨æ€é€‰æ‹©åºåˆ—åŒ–å™¨
- `get_queryset()` æ ¹æ®è§’è‰²è¿‡æ»¤æ•°æ®
- è‡ªå®šä¹‰åŠ¨ä½œä½¿ç”¨ `@action(detail=False/True)`

### å‰ç«¯ç»„åˆå¼ API

- ä½¿ç”¨ Vue 3 ç»„åˆå¼ API (`<script setup>`)
- çŠ¶æ€ç®¡ç†ä½¿ç”¨ Pinia
- ECharts å›¾è¡¨éœ€åœ¨ `onUnmounted()` æ—¶ dispose é˜²æ­¢å†…å­˜æ³„æ¼

---

## ç›¸å…³æ–‡æ¡£

- [äº§å“éœ€æ±‚æ–‡æ¡£](memory-bank/product-requirement-document.md)
- [æ¶æ„è®¾è®¡](memory-bank/architecture.md)
- [å®ç°è®¡åˆ’](memory-bank/implementation-plan.md)

---

## License

MIT License
